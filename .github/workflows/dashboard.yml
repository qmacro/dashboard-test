name: Build Dashboard

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Check out repository
        uses: actions/checkout@v2

      - name: generate
        uses: ethomson/issue-dashboard@v1
        with:
          config: |
            title: 'Test Title'
            output:
              format: markdown
              filename: 'dashboard.md'
            sections:
            - title: 'Developer Keynote'
              description: 'Open Issues and PRs'
              widgets:
              - type: number
                issue_query: 'repo:SAP-samples/teched2020-developer-keynote is:issue is:open'
                title: 'Open Issues'
                color: 'red'
              - type: number
                issue_query: 'repo:SAP-samples/teched2020-developer-keynote is:pr is:open'
                title: 'Open PRs'
                color: 'green'

      - name: publish
        run: |
          git add .
          git config user.name 'Dashboard Generator'
          git config user.email 'dashboard@example.com'
          git commit -m 'dashboard update' --allow-empty
          git push origin main
